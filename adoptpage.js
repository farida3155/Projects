// Pet Arrays
const cats = [
  {
    name: "Nemo",
    age: "5 Years",
    breed: "Shirazi",
    gender: "Male",
    neutered: "yes",
    location: "Cairo",
    image: "images/nemo.jpg"
  },
  {
    name: "Mimi",
    age: "3 Years",
    breed: "Shirazi",
    gender: "Female",
    neutered: "no",
    location: "Giza",
    image: "images/mimi.jpg"
  },
  {
    name: "Barbie",
    age: "1 Year",
    breed: "Shirazi",
    gender: "Female",
    neutered: "No",
    location: "Cairo",
    image: "images/barbie.jpeg"
  },
  {
    name: "Minnie",
    age: "1 Year",
    breed: "Shirazi",
    gender: "Female",
    neutered: "No",
    location: "Cairo",
    image: "images/minnie.jpeg"
  },
  {
    name: "Caramel",
    age: "3 Years",
    breed: "Shirazi",
    gender: "Female",
    neutered: "Yes",
    location: "Cairo",
    image: "images/caramel.jpg"
  },
  {
    name: "Bennetton",
    age: "1 Year",
    breed: "Shirazi",
    gender: "Female",
    neutered: "No",
    location: "Cairo",
    image: "images/bennetton.jpg"
  },
  {
    name: "Hadoota",
    age: "2 Years",
    breed: "Balady",
    gender: "Female",
    neutered: "No",
    location: "Ismailia",
    image: "images/hadoota.jpg"
  },
  {
    name: "Leila",
    age: "2 Years",
    breed: "Persian",
    gender: "Female",
    neutered: "No",
    location: "Port Said",
    image: "images/persian.jpg"
  },
  {
    name: "Luna",
    age: "3 Years",
    breed: "Ragdoll",
    gender: "Female",
    neutered: "Yes",
    location: "Alexandria",
    image: "images/ragdoll.jpg"
  },
  {
    name: "Snickers",
    age: "1 Year",
    breed: "Balady",
    gender: "Female",
    neutered: "No",
    location: "Cairo",
    image: "images/snickers.png"
  },
  {
    name: "Meshmesh & Simba",
    age: "2 Months",
    breed: "Shirazi/Balady",
    gender: "Female",
    neutered: "No",
    location: "Cairo",
    image: "images/twins.jpg"
  },
  {
    name: "Monkey",
    age: "5 Years",
    breed: "Shirazi/Balady",
    gender: "Male",
    neutered: "No",
    location: "Giza",
    image: "images/monkey.jpg"
  },
  {
    name: "Snow",
    age: "3 Years",
    breed: "Shirazi",
    gender: "Male",
    neutered: "Yes",
    location: "Cairo",
    image: "images/snow.jpeg"
  },
  {
    name: "Tooty",
    age: "3 Years",
    breed: "Shirazi",
    gender: "Female",
    neutered: "No",
    location: "Ismailia",
    image: "images/tooty.jpg"
  },
  {
    name: "Bondo'",
    age: "6 Years",
    breed: "Shirazi/Balady",
    gender: "Male",
    neutered: "Yes",
    location: "Cairo",
    image: "images/bondo2.jpeg"
  },
  {
    name: "Fangs",
    age: "3 Years",
    breed: "Shirazi",
    gender: "Male",
    neutered: "No",
    location: "Alexandria",
    image: "images/fangs.jpeg"
  },
  {
    name: "Moro",
    age: "4 Months",
    breed: "Ragdoll",
    gender: "Male",
    neutered: "No",
    location: "Giza",
    image: "images/moro.jpeg"
  },
  {
    name: "Kiara",
    age: "# Years",
    breed: "Ragdoll",
    gender: "Male",
    neutered: "No",
    location: "Giza",
    image: "images/moro.jpeg"
  },
];

const dogs = [
  {
  name: "Smokey",
  age: "1 Year",
  breed: "Labrador",
  gender: "Male",
  neutered: "No",
  location: "Cairo",
  image: "images/smokey.jpeg"
  },
  {
    name: "Astro",
    age: "1 Year",
    breed: "German Shepherd",
    gender: "Male",
    neutered: "No",
    location: "Cairo",
    image: "images/astro.jpeg"
  },
  {
    name: "Brownie",
    age: "4 Months",
    breed: "Dachshund",
    gender: "Male",
    neutered: "No",
    location: "Alexandria",
    image: "images/brownie.jpeg"
  },
  {
    name: "Buddy",
    age: "3 Years",
    breed: "Griffon",
    gender: "Male",
    neutered: "Yes",
    location: "Alexandria",
    image: "images/buddy.jpg"
  },
  {
    name: "Fosdo'a",
    age: "4 Years",
    breed: "Balady",
    gender: "Female",
    neutered: "No",
    location: "Giza",
    image: "images/fosdo2a.jpeg"
  },
  {
    name: "Max",
    age: "1 Year",
    breed: "Golden Retriever",
    gender: "Male",
    neutered: "No",
    location: "Giza",
    image: "images/Max.jpeg"
  },
  {
    name: "Oreo",
    age: "4 1/2 Years",
    breed: "Cocker Spaniel",
    gender: "Male",
    neutered: "No",
    location: "Port Said",
    image: "images/oreo.png"
  },
  {
    name: "Reeses",
    age: "5 Months",
    breed: "Rottweiler",
    gender: "Male",
    neutered: "No",
    location: "Port Said",
    image: "images/reeses.jpeg"
  },
  {
    name: "Steve",
    age: "3 Years",
    breed: "Corgi",
    gender: "Male",
    neutered: "No",
    location: "Cairo",
    image: "images/steve.jpeg"
  },
  {
    name: "Zaatar",
    age: "9 Months",
    breed: "Golden Retriever",
    gender: "Male",
    neutered: "No",
    location: "Cairo",
    image: "images/Zaatar.jpeg"
  },
  {
    name: "Milo",
    age: "3 Years",
    breed: "Volpino",
    gender: "Male",
    neutered: "No",
    location: "Cairo",
    image: "images/milo.jpeg"
  },
  {
    name: "Bruce",
    age: "3 Years",
    breed: "Pitbull",
    gender: "Male",
    neutered: "No",
    location: "Ismailia",
    image: "images/bruce.jpeg"
  },
  {
    name: "Bruno",
    age: "1 Year",
    breed: "German Shepherd",
    gender: "Male",
    neutered: "No",
    location: "Giza",
    image: "images/bruno.jpeg"
  },
  {
    name: "Casper",
    age: "2 Years",
    breed: "Volpino",
    gender: "Male",
    neutered: "No",
    location: "Cairo",
    image: "images/casper.jpeg"
  },
  {
    name: "Daisy",
    age: "7 Months",
    breed: "Cocker Spaniel",
    gender: "Female",
    neutered: "No",
    location: "Cairo",
    image: "images/daisy.jpeg"
  },
  {
    name: "Zoro",
    age: "5 Months",
    breed: "Cocker Spaniel",
    gender: "Male",
    neutered: "No",
    location: "Cairo",
    image: "images/zoro.jpeg"
  },
];


const pageType = document.body.dataset.page;
const pets = pageType === "dogs" ? dogs : cats;


const container = document.getElementById("petAccordion");
const form = document.getElementById("filter-form");


function renderPets(petList) {
  container.innerHTML = ""; // Clear previous listings

  if (petList.length === 0) {
    container.innerHTML = `<p style="padding: 20px;">No pets match your filters.</p>`;
    return;
  }

  petList.forEach(pet => {
    const panel = document.createElement("div");
    panel.className = "panel";
    panel.style.backgroundImage = `url(${pet.image})`;

    panel.innerHTML = `
      <div class="info">
        <strong>${pet.name}</strong><br>
        ${pet.age} • ${pet.breed} • ${pet.gender}
      </div>
    `;

    panel.addEventListener("click", () => {
      showModal(pet);
    });

    container.appendChild(panel);
  });
}

function filterPets(e) {
  e.preventDefault();

  const gender = document.getElementById("gender").value.toLowerCase();
  const age = document.getElementById("age").value; // Example: "2 years" or "6 months"
  const breed = document.getElementById("breed").value.toLowerCase();
  const neutered = document.getElementById("neutered").value.toLowerCase();
  const location = document.getElementById("location").value.toLowerCase();

  let ageValue = null;
  let ageUnit = null;

  // Parse age and unit from input, if provided
  if (age) {
    const match = age.match(/^(\d+)\s*(years?|months?)$/i);
    if (match) {
      ageValue = parseInt(match[1]);
      ageUnit = match[2].toLowerCase();
    }
  }

  const filtered = pets.filter(pet => {
    let petAgeInMonths = 0;

    // Convert pet's age to months
    if (pet.age.toLowerCase().includes("year")) {
      petAgeInMonths = parseInt(pet.age) * 12;
    } else if (pet.age.toLowerCase().includes("month")) {
      petAgeInMonths = parseInt(pet.age);
    }

    // Convert filter age to months
    const filterAgeInMonths = ageValue
      ? ageUnit.startsWith("year")
        ? ageValue * 12
        : ageValue
      : null;

    // Apply filters
    return (
      (!gender || pet.gender.toLowerCase() === gender) &&
      (!filterAgeInMonths || petAgeInMonths === filterAgeInMonths) && // Exact match for age
      (!breed || pet.breed.toLowerCase() === breed) &&
      (!neutered || pet.neutered.toLowerCase() === neutered) &&
      (!location || pet.location.toLowerCase() === location)
    );
  });

  renderPets(filtered);
}

// Attach the filter function to the form submission
form.addEventListener("submit", filterPets);
// Dark Mode
document.getElementById("darkModeToggle").addEventListener("click", function () {
  document.body.classList.toggle("dark-mode");
});

// Alternate filter form logic
document.getElementById("filter-form").addEventListener("submit", function (event) {
  event.preventDefault();

  const gender = document.getElementById("gender").value.toLowerCase();
  const age = document.getElementById("age").value; // Example: "2"
  const ageUnit = document.getElementById("age-unit").value; // Example: "years" or "months"
  const breed = document.getElementById("breed").value.toLowerCase();
  const neutered = document.getElementById("neutered").value.toLowerCase();
  const location = document.getElementById("location").value.toLowerCase();

  console.log("Filter Inputs =>", { gender, age, ageUnit, breed, neutered, location });

  let ageValue = null;
  if (age) {
      ageValue = parseInt(age);
      console.log("Parsed Age Value:", ageValue);
  }

  const filteredPets = pets.filter((pet) => {
      const matchGender = !gender || pet.gender.toLowerCase() === gender;
      const matchBreed = !breed || pet.breed.toLowerCase() === breed;
      const matchNeutered = !neutered || pet.neutered.toLowerCase() === neutered;
      const matchLocation = !location || pet.location.toLowerCase() === location;

      // Convert pet's age to months for comparison
      let petAgeInMonths = 0;
      if (pet.age.toLowerCase().includes("year")) {
          petAgeInMonths = parseInt(pet.age) * 12;
      } else if (pet.age.toLowerCase().includes("month")) {
          petAgeInMonths = parseInt(pet.age);
      }
      console.log("Pet Age String:", pet.age, "Pet Age in Months:", petAgeInMonths);

      // Convert filter age to months for comparison
      const filterAgeInMonths = ageValue
          ? ageUnit === "years"
              ? ageValue * 12
              : ageValue
          : null;

      console.log("Filter Age in Months:", filterAgeInMonths);

      const matchAge = !filterAgeInMonths || petAgeInMonths === filterAgeInMonths;

      return matchGender && matchBreed && matchNeutered && matchAge && matchLocation;
  });

  console.log("Filtered Pets:", filteredPets);
  renderFilteredPets(filteredPets);
});
document.addEventListener("DOMContentLoaded", function () {
function renderFilteredPets(filteredPets) {
  const container = document.getElementById("petListingsContainer");
  if (!container) return;

  container.innerHTML = "";
  filteredPets.forEach((pet) => {
    const petCard = document.createElement("div");
    petCard.className = "pet-card";

    const petImage = document.createElement("img");
    petImage.src = pet.image;
    petImage.alt = `${pet.breed} - ${pet.name}`;
    petCard.appendChild(petImage);

    const petName = document.createElement("h3");
    petName.textContent = pet.name;
    petCard.appendChild(petName);

    const petDetails = document.createElement("p");
    petDetails.innerHTML = `
      <strong>Age:</strong> ${pet.age}<br>
      <strong>Gender:</strong> ${pet.gender}<br>
      <strong>Breed:</strong> ${pet.breed}<br>
      <strong>Neutered:</strong> ${pet.neutered}<br>
      <strong>Location:</strong> ${pet.location}
    `;
    petCard.appendChild(petDetails);

    const adoptButton = document.createElement("button");
    adoptButton.className = "adopt-btn";
    adoptButton.textContent = "Adopt Me";
    adoptButton.addEventListener("click", () => openAdoptionForm(pet));
    petCard.appendChild(adoptButton);

    container.appendChild(petCard);
  });
}
});
function showModal(pet) {
  const modal = document.getElementById("petModal");
  const modalBody = document.getElementById("modalBody");

  modalBody.innerHTML = `
    <h3>${pet.name}</h3>
    <img src="${pet.image}" style="width: 220px; height: 260px; border-radius: 8px; margin-bottom: 5px; margin-top:-30px;">
    <p id="pshowModal"><strong>Age:</strong> ${pet.age}</p>
    <p id="pshowModal"><strong>Breed:</strong> ${pet.breed}</p>
    <p id="pshowModal"><strong>Gender:</strong> ${pet.gender}</p>
    <p id="pshowModal"><strong>Neutered:</strong> ${pet.neutered}</p>
    <p id="pshowModal"><strong>Location:</strong> ${pet.location}</p>
    <br>
    <button id="adopt-btn">Adopt Me</button>
  `;

  modal.style.display = "block";

  document.getElementById("adopt-btn").addEventListener("click", () => {
    openAdoptionForm();
  });
}

document.addEventListener("DOMContentLoaded", function () {
  const closePetModalBtn = document.getElementById("pclose");
  const petModal = document.getElementById("petModal");

  if (closePetModalBtn && petModal) {
    closePetModalBtn.addEventListener("click", () => {
      petModal.style.display = "none";
    });
  }

  window.addEventListener("click", (event) => {
    if (event.target === petModal) {
      petModal.style.display = "none";
    }
  });
});


function openAdoptionForm() {
  const modal = document.getElementById("adoption-form");
  modal.style.display = "block";
}

function closeAdoptionForm() {
  const modal = document.getElementById("adoption-form");
  modal.style.display = "none";
}

window.onclick = function (event) {
  const adoptionModal = document.getElementById("adoption-form");
  if (event.target === adoptionModal) {
    adoptionModal.style.display = "none";
  }
};

// Quiz questions and structure
const quizData = [
  {
    question: "Do you enjoy outdoor activities?",
    img: "images/q1.jpeg",
    cat: "no",
    dog: "yes"
  },
  {
    question: "Do you prefer quiet companionship?",
    img: "images/q2.jpeg",
    cat: "yes",
    dog: "no"
  },
  {
    question: "Do you like high-energy pets?",
    img: "images/q3.jpeg",
    cat: "no",
    dog: "yes"
  },
  {
    question: "Are you home often during the day?",
    img: "images/q4.jpeg",
    cat: "yes",
    dog: "no"
  },
  {
    question: "Do you enjoy playing games with pets?",
    img: "images/q5.jpeg",
    cat: "no",
    dog: "yes"
  },
  {
    question: "Would you rather have a pet that requires less maintenance?",
    img: "images/q6.jpeg",
    cat: "yes",
    dog: "no"
  },
  {
    question: "Do you like long walks or runs?",
    img: "images/q7.jpeg",
    cat: "no",
    dog: "yes"
  },
  {
    question: "Would you mind if a pet needed more space?",
    img: "images/q8.jpeg",
    cat: "no",
    dog: "yes"
  },
  {
    question: "Do you want a pet that can entertain itself?",
    img: "images/q9.jpeg",
    cat: "yes",
    dog: "no"
  },
  {
    question: "Are you looking for a cuddle buddy?",
    img: "images/q10.jpeg",
    cat: "yes",
    dog: "yes"
  }
];

// Quiz state
let userAnswers = [];
let currentSlide = 0;

function createQuizSlides() {
  const container = document.getElementById('quizSlidesContainer');
  container.innerHTML = '';
  quizData.forEach((q, i) => {
    const slide = document.createElement('div');
    slide.className = 'quiz-slide' + (i === 0 ? ' active' : '');
    slide.setAttribute('data-slide', i);

    slide.innerHTML = `
      <img src="${q.img}" alt="Quiz Image ${i+1}">
      <div class="quiz-question">${q.question}</div>
      <div class="quiz-answer-btns">
        <button class="quiz-answer-btn" data-answer="yes" data-slide="${i}">Yes</button>
        <button class="quiz-answer-btn" data-answer="no" data-slide="${i}">No</button>
      </div>
    `;
    container.appendChild(slide);
  });

  // Result slide (last)
  const resultSlide = document.createElement('div');
  resultSlide.className = 'quiz-slide';
  resultSlide.setAttribute('data-slide', quizData.length);
  resultSlide.id = 'quizResultSlide';
  resultSlide.innerHTML = `
    <div class="quiz-result" id="quizResultBox">
      <!-- Result will be filled by JS -->
    </div>
  `;
  container.appendChild(resultSlide);
}

// Show the given slide (by index)
function showQuizSlide(index, tossDirection = null) {
  const slides = document.querySelectorAll('.quiz-slide');
  slides.forEach((slide, i) => {
    slide.classList.remove('active', 'toss-left');
    if (i === index) {
      slide.classList.add('active');
    } else if (i === index-1 && tossDirection === 'left') {
      slide.classList.add('toss-left');
    }
  });
  currentSlide = index;
}

// Handle answer selection and transition
function handleQuizAnswer(e) {
  const btn = e.target.closest('.quiz-answer-btn');
  if (!btn) return;
  const answer = btn.dataset.answer;
  const slideIndex = parseInt(btn.dataset.slide);

  // Mark selected button
  btn.classList.add('selected');
  btn.parentElement.querySelectorAll('.quiz-answer-btn').forEach(b => {
    if (b !== btn) b.classList.remove('selected');
  });

  // Save answer
  userAnswers[slideIndex] = answer;

  // Transition: toss current slide to left, show next
  setTimeout(() => {
    showQuizSlide(slideIndex + 1, 'left');
    // If on result slide, calculate and show result
    if (slideIndex + 1 === quizData.length) {
      showQuizResult();
    }
  }, 350);
}

// Calculate and display result
function showQuizResult() {
  let catScore = 0, dogScore = 0;
  userAnswers.forEach((ans, i) => {
    if (ans === quizData[i].cat) catScore++;
    if (ans === quizData[i].dog) dogScore++;
  });

  let resultText = '', resultImg = '', resultSub = '';
  if (catScore > dogScore) {
    resultText = "You're best suited to adopt a <b>cat</b>!";
    resultImg = "images/cat_result.jpg";
    resultSub = "You enjoy quiet, independent, and low-maintenance companions.";
  } else if (dogScore > catScore) {
    resultText = "You're best suited to adopt a <b>dog</b>!";
    resultImg = "images/dog_result.jpg";
    resultSub = "You love playful, energetic, and loyal friends!";
  } else {
    resultText = "You're great with <b>both cats and dogs</b>!";
    resultImg = "images/both_result.jpg";
    resultSub = "You have the perfect balance to care for either!";
  }

  document.getElementById('quizResultBox').innerHTML = `
    <img src="${resultImg}" alt="Quiz Result">
    <h3>${resultText}</h3>
    <p>${resultSub}</p>
    <button class="quiz-restart-btn" onclick="restartQuiz()">Restart Quiz</button>
  `;
}

document.addEventListener('DOMContentLoaded', function() {
document.getElementById('openQuizBtn').addEventListener('click', function() {
  // reset and create slides
  userAnswers = [];
  currentSlide = 0;
  createQuizSlides();
  showQuizSlide(0);
  document.getElementById('quizModalQ').classList.add('show');
  document.body.style.overflow = 'hidden';
});
document.getElementById('closeQuizModal').addEventListener('click', function() {
  document.getElementById('quizModalQ').classList.remove('show');
  document.body.style.overflow = '';
});

// Slide answer click handling (event delegation)
document.getElementById('quizSlidesContainer').addEventListener('click', handleQuizAnswer);
});
// Restart quiz from result slide
function restartQuiz() {
  userAnswers = [];
  currentSlide = 0;
  createQuizSlides();
  showQuizSlide(0);
}
document.addEventListener('DOMContentLoaded', function() {
// Dismiss modal on outside click
document.getElementById('quizModalQ').addEventListener('mousedown', function(e) {
  if (e.target === this) {
    this.classList.remove('show');
    document.body.style.overflow = '';
  }
});
});
